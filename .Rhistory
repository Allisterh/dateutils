library(dateutils)
library(dateutils)
er <- df_long %>%
filter(series_name == "exchange rate") %>%
mutate(month = format(ref_date, "%m"), year = format(ref_date, "%Y")) %>%
group_by(month, year) %>%
summarise(value = sum(value), ref_date = end_of_month(max(ref_date)))
library(tidyverse)
df_long <- read_csv("~/BankOfAlbania/data/dt_long.csv")
er <- df_long %>%
filter(series_name == "exchange rate") %>%
mutate(month = format(ref_date, "%m"), year = format(ref_date, "%Y")) %>%
group_by(month, year) %>%
summarise(value = sum(value), ref_date = end_of_month(max(ref_date)))
View(er)
er <- df_long %>%
filter(series_name == "exchange rate") %>%
mutate(month = format(ref_date, "%m"), year = format(ref_date, "%Y")) %>%
group_by(year, month) %>%
summarise(value = sum(value), ref_date = end_of_month(max(ref_date)))
df_quarter <- df_long %>%
mutate(quarter = end_of_quarter(ref_date)) %>%
group_by(series_name, quarter) %>%
summarise(value = mean(value, na.rm = TRUE))
View(df_quarter)
View(df_quarter)
df_wide <- pivot_wider(df_quarter, names_from = series_name, values_from = value)
View(df_wide)
df_long2 <- pivot_longer(df_wide, names_to = "series_name", values_to = "value")
View(df_quarter)
df_long2 <- pivot_longer(df_wide, -quarter, names_to = "series_name", values_to = "value")
View(df_long2)
df_long2 <- df_wide %>%
pivot_longer(-quarter, names_to = "series_name", values_to = "value") %>%
arrange(series_name, quarter)
View(df_long2)
